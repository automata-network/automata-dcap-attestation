<div align="center">
  <picture>
    <source media="(prefers-color-scheme: dark)" srcset="https://raw.githubusercontent.com/automata-network/automata-brand-kit/main/PNG/ATA_White%20Text%20with%20Color%20Logo.png">
    <source media="(prefers-color-scheme: light)" srcset="https://raw.githubusercontent.com/automata-network/automata-brand-kit/main/PNG/ATA_Black%20Text%20with%20Color%20Logo.png">
    <img src="https://raw.githubusercontent.com/automata-network/automata-brand-kit/main/PNG/ATA_White%20Text%20with%20Color%20Logo.png" width="50%">
  </picture>
</div>

# Automata DCAP Attestation
[![Automata DCAP Attestation](https://img.shields.io/badge/Power%20By-Automata-orange.svg)](https://github.com/automata-network)

## Table of Contents
- [Summary](#summary)
- [Automata DCAP Attestation on EVM](#automata-dcap-attestation-on-evm)
- [Automata DCAP Attestation on Solana](#automata-dcap-attestation-on-solana)

---

## Summary

This repo serves as a code base for the Intel Data Center Attestation Primitive (DCAP) Web3-based Quote Verification program for both EVM and Solana.

Currently on the EVM, users can verify DCAP quotes with either full on-chain execution or using SNARK proofs by executing [DCAP zkVM Programs](https://github.com/automata-network/tdx-attestation-sdk/tree/main/zk) on zkVMs, such as RiscZero or Succinct SP1. We plan to add support for more zkVMs in the future.

The Solana program currently supports only SNARK proof verification.

---

## Deployment Info

Each release contains information about the deployment, such as:

- The zkVM Program Identifiers (ensuring SNARK proofs are generated by the correct zkVM Program)
- The contract addresses on EVM and/or Solana (and possibly in other ecosystem that we may support in the future)

Here are the deployment information for currently active versions:

- [Current](./releases/next/NOTE.md)
- [v1.0.0](./releases/v1.0.0/NOTE.md)

---

## Automata DCAP Attestation on EVM

It consists of three smart contracts:

- PCCS Router: A central contract to read collaterals from [`automata-on-chain-pccs`](https://github.com/automata-network/automata-on-chain-pccs)

- Automata DCAP Attestation: This is the entrypoint contract for users to submit a quote to be verified. This contract parses the Quote header to identify the version, which then forwards the quote to the respective QuoteVerifier contract. 

- Quote Verifier(s): This contract provides the full implementation to verify a given quote specific to its version. This contract is intended to be called only from the Automata DCAP Attestation contract.

### On-Chain vs SNARK Attestations

Automata DCAP Attestation contract implements two attestation methods available to users. Here is a quick comparison:

|  | On-Chain | Groth16 Proof Verification with RiscZero v2.1 | Groth16 Proof Verification with SP1 v5 | Plonk Proof Verification with SP1 v5| 
| --- | --- | --- | --- | --- |
| Quote Verification Time | Instant | Proving takes <1 minute, instant verification | [Proving takes <30s](https://explorer.succinct.xyz/request/0x07af234869635075dcbc714135ea52c71b9019ffda59e33d3aa5fb6673a724d2), instant verification  | [Proving takes <2 minutes](https://explorer.succinct.xyz/request/0x64bc5f55b3425cc8e6400597765c656c8ab4a7c18de04719e9f6595703ea9c04), instant verification |
| Gas Cost | ~4M gas (with RIP-7212 precompile); ~5M gas (without precompile) | 522k gas | 493k gas | 569k gas |
| Execution | Runs fully on-chain | Execution proven by remote prover Bonsai | Execution proven by the SP1 Network | Execution proven by the SP1 Network |

---

## Automata DCAP Attestation on Solana

> [!CAUTION]
>
> The Solana programs are not audited for production use.

> [ℹ️ **NOTE:**]
>
> We are currently working on full-fledged DCAP Attestation for the Solana ecosystem, which consists of both the Quote Verifiers and PCCS programs. You can learn more about it [here](./solana/automata-dcap-framework/README.md).
