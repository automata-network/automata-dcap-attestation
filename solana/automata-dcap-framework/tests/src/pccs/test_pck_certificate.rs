use crate::pccs::{PccsTestConfig, PccsTestHarness};

#[test]
fn test_pck_certificate_upsert() {
    let config = PccsTestConfig::default();
    let harness = PccsTestHarness::new(config);

    let qe_id = "ad04024c9dfb382baf51ca3e5d6cb6e6";
    let pce_id = "0000";
    let tcbm = "0c0c0303ffff010000000000000000000d00";

    let pck_cert_data = "308204f230820498a00302010202142a7d4efbe5d0add11a682e797092f4b691478379300a06082a8648ce3d04030230703122302006035504030c19496e74656c205347582050434b20506c6174666f726d204341311a3018060355040a0c11496e74656c20436f72706f726174696f6e3114301206035504070c0b53616e746120436c617261310b300906035504080c024341310b3009060355040613025553301e170d3233303832343231343033305a170d3330303832343231343033305a30703122302006035504030c19496e74656c205347582050434b204365727469666963617465311a3018060355040a0c11496e74656c20436f72706f726174696f6e3114301206035504070c0b53616e746120436c617261310b300906035504080c024341310b30090603550406130255533059301306072a8648ce3d020106082a8648ce3d03010703420004d191af3aa502625f6b05762a07a3f569f026c7df131843575ba11bd9e65bbb743d97676efb3f960c6b5c151b5560a63c21283885f0855eacb269e490717e5a64a382030e3082030a301f0603551d23041830168014956f5dcdbd1be1e94049c9d4f433ce01570bde54306b0603551d1f046430623060a05ea05c865a68747470733a2f2f6170692e7472757374656473657276696365732e696e74656c2e636f6d2f7367782f63657274696669636174696f6e2f76332f70636b63726c3f63613d706c6174666f726d26656e636f64696e673d646572301d0603551d0e041604140debe1129b1a74f59d72f0659aeb414600264c25300e0603551d0f0101ff0404030206c0300c0603551d130101ff040230003082023b06092a864886f84d010d010482022c30820228301e060a2a864886f84d010d01010410caedec04d9afd957c2df2db0fc34836f30820165060a2a864886f84d010d0102308201553010060b2a864886f84d010d01020102010c3010060b2a864886f84d010d01020202010c3010060b2a864886f84d010d0102030201033010060b2a864886f84d010d0102040201033011060b2a864886f84d010d010205020200ff3011060b2a864886f84d010d010206020200ff3010060b2a864886f84d010d0102070201013010060b2a864886f84d010d0102080201003010060b2a864886f84d010d0102090201003010060b2a864886f84d010d01020a0201003010060b2a864886f84d010d01020b0201003010060b2a864886f84d010d01020c0201003010060b2a864886f84d010d01020d0201003010060b2a864886f84d010d01020e0201003010060b2a864886f84d010d01020f0201003010060b2a864886f84d010d0102100201003010060b2a864886f84d010d01021102010d301f060b2a864886f84d010d01021204100c0c0303ffff010000000000000000003010060a2a864886f84d010d0103040200003014060a2a864886f84d010d0104040600606a000000300f060a2a864886f84d010d01050a0101301e060a2a864886f84d010d01060410e9ebc4da8072a2137aff4af003899dfa3044060a2a864886f84d010d010730363010060b2a864886f84d010d0107010101ff3010060b2a864886f84d010d0107020101003010060b2a864886f84d010d010703010100300a06082a8648ce3d0403020348003045022047ee02c3877b1a3b211c70a5cfd2db8b164911cff57e5cec0c83cc4d00b3f82d022100f44279902fe36437b2737997e53f1746e21cfb29efb809849fb4a0231d366ef4";


    let _tx = harness.upsert_pck_certificate(
        qe_id.to_string(),
        pce_id.to_string(),
        tcbm.to_string(),
        pck_cert_data.to_string(),
    ).unwrap();
}
