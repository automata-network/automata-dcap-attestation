# Automata DCAP Attestation

## Release Note

A production-ready release of the Automata DCAP Attestation EVM Solidity Smart Contracts. 

This release only applies to source code located in the `/evm` directory.

---

## zkProgram Identifiers

These identifiers are required parameters for SNARK proof verifications, to show that the proofs are generated by the intended zkVM Program.

The [ImageID](https://dev.risczero.com/terminology#image-id) currently for the DCAP RiscZero Guest Program is 0xd6c3b4b08fa163dd44f89125f97223f6f7163e3f0f62e360d707adab8f6b7799.

The [VKEY](https://docs.succinct.xyz/verification/onchain/solidity-sdk.html?#finding-your-program-vkey) currently for the DCAP SP1 Program is
0x0036efd519bb371b29a40322e40031833716e9441c6907f8aefc5e52ceebc9a6.

---

## Contract Deployment (EVM)

> ℹ️ **UPDATE (March 2025)**： The EVM contracts for both [Automata On Chain PCCS](https://github.com/automata-network/automata-on-chain-pccs) and Automata DCAP Attestation have been fully audited by Trails of Bit. 
>
> Click [here](https://github.com/trailofbits/publications/blob/master/reviews/2025-02-automata-dcap-attestation-onchain-pccs-securityreview.pdf) to view the audit report.

### Testnet

| Contract | Network | Address |
| --- | --- | --- |
| `PCCSRouter.sol` | Automata Testnet | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://explorer-testnet.ata.network/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | Ethereum Sepolia | [0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a](https://sepolia.etherscan.io/address/0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a) |
|  | Ethereum Holesky | [0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a](https://holesky.etherscan.io/address/0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a) |
|  | Base Sepolia | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://sepolia.basescan.org/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | OP Sepolia | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://sepolia-optimism.etherscan.io/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | World Sepolia | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://worldchain-sepolia.explorer.alchemy.com/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | Arbitrum Sepolia | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://sepolia.arbiscan.io/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | World Sepolia | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://worldchain-sepolia.explorer.alchemy.com/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | Avalanche C-Chain Fuji | [0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a](https://subnets-test.avax.network/c-chain/address/0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a) |
|  | BSC Testnet | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://testnet.bscscan.com/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | Polygon Amoy | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://amoy.polygonscan.com/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | Hoodi Testnet | [0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a](https://hoodi.etherscan.io/address/0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a) |
|  | Unichain Sepolia | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://sepolia.uniscan.xyz/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
| `AutomataDcapAttestationFee.sol` | Automata Testnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://explorer-testnet.ata.network/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Ethereum Sepolia | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://sepolia.etherscan.io/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Ethereum Holesky | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://holesky.etherscan.io/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Base Sepolia | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://sepolia.basescan.org/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | OP Sepolia | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://sepolia-optimism.etherscan.io/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Arbitrum Sepolia | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://sepolia.arbiscan.io/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | World Sepolia | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://worldchain-sepolia.explorer.alchemy.com/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Avalanche C-Chain Fuji | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://subnets-test.avax.network/c-chain/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | BSC Testnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://testnet.bscscan.com/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Polygon Amoy | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://amoy.polygonscan.com/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Hoodi Testnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://hoodi.etherscan.io/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Unichain Sepolia | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://sepolia.uniscan.xyz/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
| `V3QuoteVerifier.sol` | Automata Testnet | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://explorer-testnet.ata.network/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | Ethereum Sepolia | [0x816ADa3B63F3c643fb04152eA32B58Db89aadd89](https://sepolia.etherscan.io/address/0x816ADa3B63F3c643fb04152eA32B58Db89aadd89) |
|  | Ethereum Holesky | [0x816ADa3B63F3c643fb04152eA32B58Db89aadd89](https://holesky.etherscan.io/address/0x816ADa3B63F3c643fb04152eA32B58Db89aadd89) |
|  | Base Sepolia | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://sepolia.basescan.org/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | OP Sepolia | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://sepolia-optimism.etherscan.io/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | World Sepolia | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://worldchain-sepolia.explorer.alchemy.com/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | Arbitrum Sepolia | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://sepolia.arbiscan.io/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | World Sepolia | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://worldchain-sepolia.explorer.alchemy.com/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | Avalanche C-Chain Fuji | [0x816ADa3B63F3c643fb04152eA32B58Db89aadd89](https://subnets-test.avax.network/c-chain/address/0x816ADa3B63F3c643fb04152eA32B58Db89aadd89) |
|  | BSC Testnet | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://testnet.bscscan.com/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | Polygon Amoy | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://amoy.polygonscan.com/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | Hoodi Testnet | [0x816ADa3B63F3c643fb04152eA32B58Db89aadd89](https://hoodi.etherscan.io/address/0x816ADa3B63F3c643fb04152eA32B58Db89aadd89) |
|  | Unichain Sepolia | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://sepolia.uniscan.xyz/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
| `V4QuoteVerifier.sol` | Automata Testnet | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://explorer-testnet.ata.network/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | Ethereum Sepolia | [0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8](https://sepolia.etherscan.io/address/0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8) |
|  | Ethereum Holesky | [0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8](https://holesky.etherscan.io/address/0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8) |
|  | Base Sepolia | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://sepolia.basescan.org/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | OP Sepolia | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://sepolia-optimism.etherscan.io/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | Arbitrum Sepolia | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://sepolia.arbiscan.io/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | World Sepolia | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://worldchain-sepolia.explorer.alchemy.com/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | Avalanche C-Chain Fuji | [0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8](https://subnets-test.avax.network/c-chain/address/0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8) |
|  | BSC Testnet | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://testnet.bscscan.com/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | Polygon Amoy | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://amoy.polygonscan.com/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | Hoodi Testnet | [0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8](https://hoodi.etherscan.io/address/0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8) |
|  | Unichain Sepolia | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://sepolia.uniscan.xyz/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |

### Mainnet

| Contract | Network | Address |
| --- | --- | --- |
| `PCCSRouter.sol` | Automata Mainnet | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://explorer.ata.network/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | Ethereum Mainnet | [0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a](https://etherscan.io/address/0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a) |
|  | Base Mainnet | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://basescan.org/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | OP Mainnet | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://optimistic.etherscan.io/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | World Mainnet | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://worldchain-mainnet.explorer.alchemy.com/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | Arbitrum Mainnet | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://arbiscan.io/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | Polygon PoS Mainnet | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://polygonscan.com/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | BSC Mainnet | [0x0d089B3fA00CBAD0a5098025519e9e4620622acF](https://bscscan.com/address/0x0d089B3fA00CBAD0a5098025519e9e4620622acF) |
|  | Avalanche C-Chain | [0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a](https://subnets.avax.network/c-chain/address/0xe20C4d54afBbea5123728d5b7dAcD9CB3c65C39a) |
| `AutomataDcapAttestationFee.sol` | Automata Mainnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://explorer.ata.network/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Ethereum Mainnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://etherscan.io/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Base Mainnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://basescan.org/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | OP Mainnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://optimistic.etherscan.io/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | World Mainnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://worldchain-mainnet.explorer.alchemy.com/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Arbitrum Mainnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://arbiscan.io/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Polygon PoS Mainnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://polygonscan.com/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | BSC Mainnet | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://bscscan.com/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
|  | Avalanche C-Chain | [0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF](https://subnets.avax.network/c-chain/address/0x95175096a9B74165BE0ac84260cc14Fc1c0EF5FF) |
| `V3QuoteVerifier.sol` | Automata Mainnet | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://explorer.ata.network/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | Ethereum Mainnet | [0x816ADa3B63F3c643fb04152eA32B58Db89aadd89](https://etherscan.io/address/0x816ADa3B63F3c643fb04152eA32B58Db89aadd89) |
|  | Base Mainnet | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://basescan.org/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | OP Mainnet | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://optimistic.etherscan.io/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | World Mainnet | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://worldchain-mainnet.explorer.alchemy.com/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | Arbitrum Mainnet | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://arbiscan.io/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | Polygon PoS Mainnet | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://polygonscan.com/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | BSC Mainnet | [0x69523d25E25e5c78d828Df90459b75F189D40Cf7](https://bscscan.com/address/0x69523d25E25e5c78d828Df90459b75F189D40Cf7) |
|  | Avalanche C-Chain | [0x816ADa3B63F3c643fb04152eA32B58Db89aadd89](https://subnets.avax.network/c-chain/address/0x816ADa3B63F3c643fb04152eA32B58Db89aadd89) |
| `V4QuoteVerifier.sol` | Automata Mainnet | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://explorer.ata.network/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | Ethereum Mainnet | [0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8](https://etherscan.io/address/0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8) |
|  | Base Mainnet | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://basescan.org/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | OP Mainnet | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://optimistic.etherscan.io/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | World Mainnet | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://worldchain-mainnet.explorer.alchemy.com/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | Arbitrum Mainnet | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://arbiscan.io/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | Polygon PoS Mainnet | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://polygonscan.com/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | BSC Mainnet | [0xD34Cf419AF06629e158DB5F67541AaF2230290FB](https://bscscan.com/address/0xD34Cf419AF06629e158DB5F67541AaF2230290FB) |
|  | Avalanche C-Chain | [0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8](https://subnets.avax.network/c-chain/address/0x1a9E873C041F566fCBAdbD9e1358095b7Ea12AA8) |

---

## What's Changed?

- The contract has been fully audited by Trail of Bits.  
  [🔗 View the full audit report](https://github.com/trailofbits/publications/blob/master/reviews/2025-02-automata-dcap-attestation-onchain-pccs-securityreview.pdf)

- Integrated [RIP-7212](https://github.com/ethereum/RIPs/blob/master/RIPS/rip-7212.md) for cheaper secp256r1 ECDSA verification on supported networks.

- TEE Type values are encoded and handled in little-endian order.

- Intel PCK Certificate Chain must now contain exactly 3 X509 Certificates.

- PCCS Router checks the validity window before loading the full collateral data, which prevents wasting gas on loading expired collaterals into memory.

- Checks Attestation Timestamp for Quote Verifications with ZK.

- Checks `TcbInfo` and `QEIdentity` for Quote Verification with ZK.

- Event logs are emitted for all state-changing functions.

---

[👉 Full Changelog (`v0.1.1...evm-v1.0.0`)](https://github.com/automata-network/automata-dcap-attestation/compare/v0.1.1...evm-v1.0.0)